xyplot(mp$P ~ mp$DATE, type = "h")
xyplot(kp$P ~ kp$DATE, type = "h")
xyplot(ap$P ~ ap$DATE, type = "h")
xyplot(mp$P ~ mp$DATE, type = "h")
xyplot(mp$P ~ mp$DATE, type = "h")
xyplot(meanp$P ~ meanp$DATE, type = "h")
xyplot(ap$P ~ ap$DATE, type = "h")
xyplot(kp$P ~ kp$DATE, type = "h")
xyplot(mp$P ~ mp$DATE, type = "h")
xyplot(ap$P ~ ap$DATE, type = "h")
xyplot(meanp$P ~ meanp$DATE, type = "h")
xyplot(kp$P ~ kp$DATE, type = "h")
moshi2 <- read.csv("moshi_precip_1950_1990.csv", stringsAsFactors = FALSE)
setwd("D:/active/kilimanjaro/scripts/paper_kilimanjaro_climate_dynamics/src")
moshi2 <- read.csv("moshi_precip_1950_1990.csv", stringsAsFactors = FALSE)
moshi2
head(moshi2)
as.Date(moshi2$Date, "%Y%m%d")
as.Date(moshi2$Date, "%Y-%m-%d")
moshi2$Date <- as.Date(moshi2$Date, "%Y-%m-%d")
xyplot(moshi2$P ~ moshi2$Date, type = "h")
head(moshi2)
xyplot(moshi2$precip ~ moshi2$Date, type = "h")
xyplot(mp$P ~ mp$DATE, type = "h")
moshi2
mp
mp[c(215:225),]
moshi2
mp[c(215:225),]
mp[c(210:225),]
moshi2
mp[c(210:225),]
xyplot(mp[c(210:225),2]~mp[c(210:225),3], type = "h")
kia2 <- read.csv("TZ000063791.dly", stringsAsFactors = FALSE, del = " ")
?read.csv
kia2 <- read.csv("TZ000063791.dly", stringsAsFactors = FALSE, sep = " ")
kia2
head(kia2)
kia2 <- read.csv("TZ000063791.dly", stringsAsFactors = FALSE, sep = " ", strip.white = TRUE)
head(kia2)
kia2 <- read.csv("TZ000063791.dly", stringsAsFactors = FALSE, sep = ",")
head(kia2)
kia2 <- read.csv("TZ000063791.dly", stringsAsFactors = FALSE, sep = ",", header = FALSE)
head(kia2)
kia2[,c(1,seq(2,62,2))]
head(kia2[,c(1,seq(2,62,2))])
head(kia2)
kia2 <- head(kia2[,c(1,seq(2,62,2))])
?rowsums
?rowsum
rowsum(kia2[,-1])
rowsum(kia2[2:4])
?rowSums
rowSums(kia2[,-1])
rowSums(kia2[2:32])
colSums(kia2[,-1])
head(kia2,30)
kia2
kia2 <- read.csv("TZ000063791.dly", stringsAsFactors = FALSE, sep = ",", header = FALSE)
kia2 <- kia2[,c(1,seq(2,62,2))]
rowSums(kia2[,-1])
rowSums(kia2[,c(2:3)])
ncols(kia2)
nCols(kia2)
?ncols
ncol(kia2)
rowSums(kia2[,c(2:32)])
rowSums(kia2[,c(2:31)])
head(kia2)
rowSums(kia2[,-1], na.rm = TRUE)
kia2$P <- rowSums(kia2[,-1], na.rm = TRUE)
substr(kia2[,1], 12,16)
substr(kia2[,1], 12,17)
substr(kia2[,1], 12,18)
substr(kia2[,1], 12,17)
paste0(substr(kia2[,1], 12,17), "01")
as.Date(paste0(substr(kia2[,1], 12,17), "01"), "%Y%m%d")
kia2$Date <- as.Date(paste0(substr(kia2[,1], 12,17), "01"), "%Y%m%d")
xyplot(kia2$P ~ kia2$Date, type = "h")
summary(kia2)
kia2[,]
kia2[,]==-9999
kia2[kia2[,]==-9999]
kia2
kia2[kia2[,] == -9999]
kia2[kia2[,] == -9999] <- NA
kia2 <- read.csv("TZ000063791.dly", stringsAsFactors = FALSE, sep = ",", header = FALSE)
kia2 <- kia2[,c(1,seq(2,62,2))]
kia2[kia2[,] == -9999] <- NA
kia2$P <- rowSums(kia2[,-1], na.rm = TRUE)
kia2$Date <- as.Date(paste0(substr(kia2[,1], 12,17), "01"), "%Y%m%d")
xyplot(kia2$P ~ kia2$Date, type = "h")
xyplot(kp$P ~ kp$DATE, type = "h")
tail(kia2)
kp
0.4*25
0.04*25
0.20+2.17+0.20+0.12
2.69*25
2.69*25*2
0.20+2.17+0.20+0.12+0.20+0.04
2.93*50
#### Set working environment ###################################################
library(ggplot2)
setwd("D:/active/paper_kilimanjaro_climate_dynamics")
rf <- read.table("metoffice_1973-2013.csv", header = TRUE, sep = ";", dec = ".")
rf$YEAR <- as.Date(as.character(rf$YEAR))
head(rf)
rfa <- lapply(seq(2, length(colnames(rf))), function(x){
ret <- aggregate(rf[, x], by = list(substr(rf$YEAR, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Rainfall")
ret$Station <- colnames(rf)[x]
return(ret)
})
rfa <- do.call("rbind", rfa)
for (x in unique(rfa$Station)){
print(x)
print(summary(lm(Rainfall ~ time(Year), data = rfa[rfa$Station == x,])))
}
atk <- read.table("noaa_gsod_kia_1973_2013_reformat_sd_li_jl_ssa.csv",
header = TRUE, sep = ",", dec = ".")
atk
atn <- read.table("noaa_gsod_nairobi_1973_2013_reformat_sd_li_jl_ssa.csv",
header = TRUE, sep = ",", dec = ".")
head(atk)
atk$Datetime <- as.Date(atk$Datetime)
head(atk)
atn$Datetime <- as.Date(atn$Datetime)
atk <- read.table("noaa_gsod_kia_1973_2013_reformat_sd_li_jl_ssa.csv",
header = TRUE, sep = ",", dec = ".")
atn <- read.table("noaa_gsod_nairobi_1973_2013_reformat_sd_li_jl_ssa.csv",
header = TRUE, sep = ",", dec = ".")
rf <- read.table("metoffice_1973-2013.csv", header = TRUE, sep = ";", dec = ".")
atk$Datetime <- as.Date(atk$Datetime)
atn$Datetime <- as.Date(atn$Datetime)
rf$YEAR <- as.Date(as.character(rf$YEAR))
atka <- lapply(seq(2, length(colnames(atk))), function(x){
atka <- lapply(seq(2, length(colnames(atk))), function(x){
ret <- aggregate(atk[, x], by = list(substr(atk$YEAR, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Rainfall")
ret$Station <- colnames(atk)[x]
return(ret)
})
atka <- do.call("rbind", atka)
atka <- lapply(seq(2, length(colnames(atk))), function(x){
ret <- aggregate(atk[, x], by = list(substr(atk$Datetime, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Rainfall")
ret$Station <- colnames(atk)[x]
return(ret)
})
atka <- do.call("rbind", atka)
tk$Datetime
colnames(atk)
atka <- lapply(seq(9, length(colnames(atk))), function(x){
ret <- aggregate(atk[, x], by = list(substr(atk$Datetime, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Rainfall")
ret$Station <- colnames(atk)[x]
return(ret)
})
atka <- do.call("rbind", atka)
atka
atka <- lapply(seq(9, length(colnames(atk))), function(x){
ret <- aggregate(atk[, x], by = list(substr(atk$Datetime, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Rainfall")
ret$Parameter <- colnames(atk)[x]
return(ret)
})
atka <- do.call("rbind", atka)
atka
atna <- lapply(seq(9, length(colnames(atn))), function(x){
atna <- lapply(seq(9, length(colnames(atn))), function(x){
ret <- aggregate(atn[, x], by = list(substr(atn$Datetime, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Rainfall")
ret$Parameter <- colnames(atn)[x]
return(ret)
})
atna <- do.call("rbind", atna)
rfa <- lapply(seq(2, length(colnames(rf))), function(x){
ret <- aggregate(rf[, x], by = list(substr(rf$YEAR, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Rainfall")
ret$Parameter <- colnames(rf)[x]
return(ret)
})
rfa <- do.call("rbind", rfa)
rfa <- lapply(seq(2, length(colnames(rf))), function(x){
ret <- aggregate(rf[, x], by = list(substr(rf$YEAR, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Rainfall")
ret$Parameter <- colnames(rf)[x]
return(ret)
})
rfa <- do.call("rbind", rfa)
setwd("D:/active/paper_kilimanjaro_climate_dynamics")
atk <- read.table("noaa_gsod_kia_1973_2013_reformat_sd_li_jl_ssa.csv",
header = TRUE, sep = ",", dec = ".")
atn <- read.table("noaa_gsod_nairobi_1973_2013_reformat_sd_li_jl_ssa.csv",
header = TRUE, sep = ",", dec = ".")
rf <- read.table("metoffice_1973-2013.csv", header = TRUE, sep = ";", dec = ".")
atk$Datetime <- as.Date(atk$Datetime)
atn$Datetime <- as.Date(atn$Datetime)
rf$YEAR <- as.Date(as.character(rf$YEAR))
atka <- lapply(seq(9, length(colnames(atk))), function(x){
ret <- aggregate(atk[, x], by = list(substr(atk$Datetime, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Rainfall")
ret$Parameter <- colnames(atk)[x]
return(ret)
})
atka <- do.call("rbind", atka)
atna <- lapply(seq(9, length(colnames(atn))), function(x){
ret <- aggregate(atn[, x], by = list(substr(atn$Datetime, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Rainfall")
ret$Parameter <- colnames(atn)[x]
return(ret)
})
atna <- do.call("rbind", atna)
rfa <- lapply(seq(2, length(colnames(rf))), function(x){
ret <- aggregate(rf[, x], by = list(substr(rf$YEAR, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Rainfall")
ret$Parameter <- colnames(rf)[x]
return(ret)
})
rfa <- do.call("rbind", rfa)
atka <- lapply(seq(9, length(colnames(atk))), function(x){
ret <- aggregate(atk[, x], by = list(substr(atk$Datetime, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Temperature")
ret$Parameter <- colnames(atk)[x]
return(ret)
})
atka <- do.call("rbind", atka)
atna <- lapply(seq(9, length(colnames(atn))), function(x){
ret <- aggregate(atn[, x], by = list(substr(atn$Datetime, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Temperature")
ret$Parameter <- colnames(atn)[x]
return(ret)
})
atna <- do.call("rbind", atna)
rfa <- lapply(seq(2, length(colnames(rf))), function(x){
ret <- aggregate(rf[, x], by = list(substr(rf$YEAR, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Rainfall")
ret$Parameter <- colnames(rf)[x]
return(ret)
})
rfa <- do.call("rbind", rfa)
# Air temperature KIA
for (x in unique(rfa$Parameter)){
print(x)
print(summary(lm(Temperature ~ time(Year), data = rfa[rfa$Parameter == x,])))
}
for (x in unique(atka$Parameter)){
print(x)
print(summary(lm(Temperature ~ time(Year), data = atka[atka$Parameter == x,])))
}
#### Set working environment ###################################################
library(ggplot2)
setwd("D:/active/paper_kilimanjaro_climate_dynamics")
atk <- read.table("noaa_gsod_kia_1973_2013_reformat_sd_li_jl_ssa.csv",
header = TRUE, sep = ",", dec = ".")
atn <- read.table("noaa_gsod_nairobi_1973_2013_reformat_sd_li_jl_ssa.csv",
header = TRUE, sep = ",", dec = ".")
rf <- read.table("metoffice_1973-2013.csv", header = TRUE, sep = ";", dec = ".")
atk$Datetime <- as.Date(atk$Datetime)
atn$Datetime <- as.Date(atn$Datetime)
rf$YEAR <- as.Date(as.character(rf$YEAR))
atka <- lapply(seq(9, length(colnames(atk))), function(x){
ret <- aggregate(atk[, x], by = list(substr(atk$Datetime, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Temperature")
ret$Parameter <- colnames(atk)[x]
return(ret)
})
atka <- do.call("rbind", atka)
atna <- lapply(seq(9, length(colnames(atn))), function(x){
ret <- aggregate(atn[, x], by = list(substr(atn$Datetime, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Temperature")
ret$Parameter <- colnames(atn)[x]
return(ret)
})
atna <- do.call("rbind", atna)
rfa <- lapply(seq(2, length(colnames(rf))), function(x){
ret <- aggregate(rf[, x], by = list(substr(rf$YEAR, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Rainfall")
ret$Parameter <- colnames(rf)[x]
return(ret)
})
rfa <- do.call("rbind", rfa)
# Air temperature KIA
for (x in unique(atka$Parameter)){
print(x)
print(summary(lm(Temperature ~ time(Year), data = atka[atka$Parameter == x,])))
}
# Air temperature Nairobi
for (x in unique(atna$Parameter)){
print(x)
print(summary(lm(Temperature ~ time(Year), data = atna[atna$Parameter == x,])))
}
# Rainfall
for (x in unique(rfa$Parameter)){
print(x)
print(summary(lm(Rainfall ~ time(Year), data = rfa[rfa$Parameter == x,])))
}
#### Set working environment ###################################################
library(ggplot2)
setwd("D:/active/paper_kilimanjaro_climate_dynamics")
atk <- read.table("noaa_gsod_kia_1973_2013_reformat_sd_li_jl_ssa.csv",
header = TRUE, sep = ",", dec = ".")
atn <- read.table("noaa_gsod_nairobi_1973_2013_reformat_sd_li_jl_ssa.csv",
header = TRUE, sep = ",", dec = ".")
rf <- read.table("metoffice_1973-2013.csv", header = TRUE, sep = ";", dec = ".")
atk$Datetime <- as.Date(atk$Datetime)
atn$Datetime <- as.Date(atn$Datetime)
rf$YEAR <- as.Date(as.character(rf$YEAR))
atka <- lapply(seq(9, length(colnames(atk))), function(x){
ret <- aggregate(atk[, x], by = list(substr(atk$Datetime, 1, 4)), FUN = "mean")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Temperature")
ret$Parameter <- colnames(atk)[x]
return(ret)
})
atka <- do.call("rbind", atka)
atna <- lapply(seq(9, length(colnames(atn))), function(x){
ret <- aggregate(atn[, x], by = list(substr(atn$Datetime, 1, 4)), FUN = "mean")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Temperature")
ret$Parameter <- colnames(atn)[x]
return(ret)
})
atna <- do.call("rbind", atna)
rfa <- lapply(seq(2, length(colnames(rf))), function(x){
ret <- aggregate(rf[, x], by = list(substr(rf$YEAR, 1, 4)), FUN = "sum")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Rainfall")
ret$Parameter <- colnames(rf)[x]
return(ret)
})
rfa <- do.call("rbind", rfa)
# Air temperature KIA
for (x in unique(atka$Parameter)){
print(x)
print(summary(lm(Temperature ~ time(Year), data = atka[atka$Parameter == x,])))
}
# Air temperature Nairobi
for (x in unique(atna$Parameter)){
print(x)
print(summary(lm(Temperature ~ time(Year), data = atna[atna$Parameter == x,])))
}
# Rainfall
for (x in unique(rfa$Parameter)){
print(x)
print(summary(lm(Rainfall ~ time(Year), data = rfa[rfa$Parameter == x,])))
}
library(quantreg)
print(summary(rq(Rainfall ~ time(Year), data = rfa[rfa$Parameter == "P_MEAN_NEW",])))
print(summary(rq(Rainfall ~ time(Year), tau = seq(0, 1, 0.01),
data = rfa[rfa$Parameter == "P_MEAN_NEW",])))
print(summary(rq(Rainfall ~ time(Year), tau = seq(0, 1, 0.1),
data = rfa[rfa$Parameter == "P_MEAN_NEW",])))
print(summary(rq(Rainfall ~ time(Year), tau = seq(0.9, 1, 0.01),
data = rfa[rfa$Parameter == "P_MEAN_NEW",])))
print(summary(rq(Rainfall ~ time(Year), tau = seq(0.9, 1, 0.01),
data = rfa[rfa$Parameter == "P_MOSHI_NEW",])))
print(summary(rq(Rainfall ~ time(Year), tau = seq(0.9, 1, 0.01),
data = rfa[rfa$Parameter == "P_KIA_NEW",])))
print(summary(rq(Rainfall ~ time(Year), tau = seq(0.9, 1, 0.01),
data = rfa[rfa$Parameter == "P_MEAN_NEW",])))
head(rf)
print(summary(rq(P_MEAN_NEW ~ time(YEAR), tau = seq(0.9, 1, 0.01), data = rfa)))
print(summary(rq(P_MEAN_NEW ~ time(YEAR), tau = seq(0.9, 1, 0.01), data = rf)))
print(summary(rq(P_MEAN_NEW ~ time(YEAR), tau = seq(0.8, 1, 0.1), data = rf)))
print(summary(rq(P_MEAN_NEW ~ YEAR, tau = seq(0.8, 1, 0.1), data = rf)))
print(summary(rq(P_MEAN_NEW ~ YEAR, tau = seq(0.8, 1, 0.05), data = rf)))
print(summary(rq(P_MEAN_NEW ~ time(YEAR), tau = seq(0.8, 1, 0.05), data = rf)))
head(rf)
print(summary(rq(Rainfall ~ time(Year), tau = seq(0.8, 1, 0.05),
data = rfa[rfa$Parameter == "P_MEAN_NEW",])))
print(summary(rq(P_MEAN_NEW ~ time(YEAR), tau = seq(0.8, 1, 0.05), data = rf)))
print(summary(rq(P_MEAN_NEW ~ time(YEAR), tau = seq(0.5, 1, 0.05), data = rf)))
atkgaps <- read.table("noaa_gsod_kia_1973_2013_reformat.csv",
header = TRUE, sep = ",", dec = ".")
atkgaps
head(atkgaps)
atkgaps$Datetime <- as.Date(atkgaps$Datetime)
atngaps$Datetime <- as.Date(atngaps$Datetime)
atngaps <- read.table("noaa_gsod_nairobi_1973_2013_reformat.csv",
header = TRUE, sep = ",", dec = ".")
atn$Datetime <- as.Date(atn$Datetime)
atka <- lapply(seq(9, length(colnames(atkgaps))), function(x){
ret <- aggregate(atkgaps[, x], by = list(substr(atkgaps$Datetime, 1, 4)), FUN = "mean")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Temperature")
ret$Parameter <- colnames(atkgaps)[x]
return(ret)
})
atka <- do.call("rbind", atka)
atna <- lapply(seq(9, length(colnames(atngaps))), function(x){
ret <- aggregate(atngaps[, x], by = list(substr(atngaps$Datetime, 1, 4)), FUN = "mean")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Temperature")
ret$Parameter <- colnames(atngaps)[x]
return(ret)
})
atna <- do.call("rbind", atna)
for (x in unique(atkgapsa$Parameter)){
print(x)
print(summary(lm(Temperature ~ time(Year), data = atkgapsa[atkgapsa$Parameter == x,])))
}
atkagaps <- lapply(seq(9, length(colnames(atkgaps))), function(x){
ret <- aggregate(atkgaps[, x], by = list(substr(atkgaps$Datetime, 1, 4)), FUN = "mean")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Temperature")
ret$Parameter <- colnames(atkgaps)[x]
return(ret)
})
atkagaps <- do.call("rbind", atkagaps)
atnagaps <- lapply(seq(9, length(colnames(atngaps))), function(x){
ret <- aggregate(atngaps[, x], by = list(substr(atngaps$Datetime, 1, 4)), FUN = "mean")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Temperature")
ret$Parameter <- colnames(atngaps)[x]
return(ret)
})
atnagaps <- do.call("rbind", atnagaps)
for (x in unique(atka$Parameter)){
print(x)
print(summary(lm(Temperature ~ time(Year), data = atkagaps[atkagaps$Parameter == x,])))
}
head(atkagaps)
atkgaps <- read.table("noaa_gsod_kia_1973_2013_reformat.csv",
header = TRUE, sep = ",", dec = ".")
atngaps <- read.table("noaa_gsod_nairobi_1973_2013_reformat.csv",
header = TRUE, sep = ",", dec = ".")
summary(atkgaps)
atkgaps$Datetime <- as.Date(atkgaps$Datetime)
atngaps$Datetime <- as.Date(atngaps$Datetime)
atkagaps <- lapply(seq(9, length(colnames(atkgaps))), function(x){
ret <- aggregate(atkgaps[, x], by = list(substr(atkgaps$Datetime, 1, 4)), FUN = "mean")
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Temperature")
ret$Parameter <- colnames(atkgaps)[x]
return(ret)
})
atkagaps <- do.call("rbind", atkagaps)
atkagaps
?aggregate
atkagaps <- lapply(seq(9, length(colnames(atkgaps))), function(x){
ret <- aggregate(atkgaps[, x], by = list(substr(atkgaps$Datetime, 1, 4)),
FUN = "mean", na.action = na.omit)
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Temperature")
ret$Parameter <- colnames(atkgaps)[x]
return(ret)
})
atkagaps <- do.call("rbind", atkagaps)
atkagaps
atkagaps <- lapply(seq(9, length(colnames(atkgaps))), function(x){
ret <- aggregate(atkgaps[, x], by = list(substr(atkgaps$Datetime, 1, 4)),
FUN = "mean", na.rm=TRUE, na.action=NULL)
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Temperature")
ret$Parameter <- colnames(atkgaps)[x]
return(ret)
})
atkagaps <- do.call("rbind", atkagaps)
atkagaps
atnagaps <- lapply(seq(9, length(colnames(atngaps))), function(x){
ret <- aggregate(atngaps[, x], by = list(substr(atngaps$Datetime, 1, 4)),
FUN = "mean", na.rm=TRUE, na.action=NULL))
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Temperature")
ret$Parameter <- colnames(atngaps)[x]
return(ret)
})
atnagaps <- do.call("rbind", atnagaps)
atnagaps <- lapply(seq(9, length(colnames(atngaps))), function(x){
ret <- aggregate(atngaps[, x], by = list(substr(atngaps$Datetime, 1, 4)),
FUN = "mean", na.rm=TRUE, na.action=NULL)
ret$Group.1 <- as.Date(ret$Group.1, format = "%Y")
colnames(ret) <- c("Year", "Temperature")
ret$Parameter <- colnames(atngaps)[x]
return(ret)
})
atnagaps <- do.call("rbind", atnagaps)
for (x in unique(atka$Parameter)){
print(x)
print(summary(lm(Temperature ~ time(Year), data = atkagaps[atkagaps$Parameter == x,])))
}
for (x in unique(atkagaps$Parameter)){
print(x)
print(summary(lm(Temperature ~ time(Year), data = atkagaps[atkagaps$Parameter == x,])))
}
for (x in unique(atnagaps$Parameter)){
print(x)
print(summary(lm(Temperature ~ time(Year), data = atnagaps[atnagaps$Parameter == x,])))
}
for (x in unique(atkagaps$Parameter)){
print(x)
print(summary(lm(Temperature ~ time(Year), data = atkagaps[atkagaps$Parameter == x,])))
}
